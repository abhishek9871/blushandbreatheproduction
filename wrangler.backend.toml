name = "jyotilalchandani-backend"
compatibility_date = "2024-09-01"
compatibility_flags = ["nodejs_compat"]
main = "_worker.js"

# Cron trigger for news aggregator (runs every hour)
[triggers]
crons = ["0 * * * *"]

[[kv_namespaces]]
binding = "MERGED_CACHE"
id = "8c4c045cf255490a8b9146ab393bd0e0"

[[kv_namespaces]]
binding = "EBAY_TOKEN"
id = "1ea1e1dccdd04b2898f3700fd91a18c9"

[[kv_namespaces]]
binding = "SUGGESTIONS"
id = "60392e62d508494b8f509e3ad8f3ddec"

[[kv_namespaces]]
binding = "OVERRIDES"
id = "4de8728f89104b92911d47ce70f70744"

[[kv_namespaces]]
binding = "AFFILIATE_KV"
id = "63dd4c653efb42eb8b46714e9def97f4"

[[kv_namespaces]]
binding = "NUTRITION_CACHE"
id = "cf7453d1b2794240a9bf909ee86eda2f"

# ═══════════════════════════════════════════════════════════════════
# SUBSTANCE EDUCATION KV NAMESPACES
# Note: Create these in Cloudflare dashboard and update IDs
# ═══════════════════════════════════════════════════════════════════

[[kv_namespaces]]
binding = "SUBSTANCE_CACHE"
id = "ae605f986088485a8e8d3d6632064f94"

[[kv_namespaces]]
binding = "MEDICINE_CACHE"
id = "44523f6edb7e4f569069711683557bb9"

[[kv_namespaces]]
binding = "AFFILIATE_DATA"
id = "8bd7397d53744071844cd73f7abe2bff"

[[durable_objects.bindings]]
name = "AFFILIATE_DO"
class_name = "AffiliateCounter"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["AffiliateCounter"]

[vars]
OBF_BASE_URL = "https://world.openbeautyfacts.org"
MERGED_TTL_SECONDS = "14400"
# EBAY_CLIENT_ID and EBAY_CLIENT_SECRET set via: wrangler secret put
EBAY_ENV = "PROD"
EBAY_CAMPAIGN_ID = "PLACEHOLDER"
# UNSPLASH_ACCESS_KEY set via wrangler secrets

[env.production.vars]
OBF_BASE_URL = "https://world.openbeautyfacts.org"
MERGED_TTL_SECONDS = "14400"
# EBAY_CLIENT_ID and EBAY_CLIENT_SECRET set via wrangler secrets
EBAY_ENV = "PROD"
EBAY_CAMPAIGN_ID = "PLACEHOLDER"
# UNSPLASH_ACCESS_KEY set via wrangler secrets

[env.preview.vars]
OBF_BASE_URL = "https://world.openbeautyfacts.org"
MERGED_TTL_SECONDS = "14400"
# UNSPLASH_ACCESS_KEY set via wrangler secrets
